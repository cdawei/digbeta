\section{New song recommendation as multi-label classification}

Alternatively, we can formulate the new song recommendation as a multi-label classification problem,
where we learn a classifier which hopefully assign positive labels to songs in playlist and negative labels to those not.
The features of song $m$ are song audio features, genre and popularity, in contrast to playlist augmentation,
here the listening events from other users are not available due to songs in test set are cold-start items.

The optimisation objective is:
\begin{equation*}
\begin{aligned}
J &= \frac{\lambda}{2} \left( \frac{1}{U} \sum_{u=1}^U \bv_u^\top \bv_u 
     + \frac{1}{N} \sum_{i=1}^N \w_i^\top \w_i + \mubm^\top \mubm \right) \\
& \hspace{1.5em}
     + \frac{1}{N} \sum_{i=1}^N \left( \frac{1}{M_i^+} \sum_{m: y_i^m = 1} e^{-(\bv_{u(i)} + \w_i + \mubm)^\top \x^m} 
     + \frac{1}{(M - M_i^+) p} \sum_{n: y_i^n = 0} e^{p (\bv_{u(i)} + \w_i + \mubm)^\top \x^n} \right),
\end{aligned}
\end{equation*}
where $\lambda > 0$ is a regularisation constant.


The gradient w.r.t. $\bv_u, \w_i$ and $\mubm$ are
\begin{equation*}
\begin{aligned}
\frac{\partial J}{\partial \bv_u}
&= \frac{\lambda}{U} \bv_u + \frac{1}{N} \sum_{i \in P_u} \left( 
   \frac{-1}{M_i^+} \sum_{m: y_i^m = 1} \x^m e^{-(\bv_{u} + \w_i + \mubm)^\top \x^m} 
   + \frac{1}{(M - M_i^+)} \sum_{n: y_i^n = 0} \x^n e^{p (\bv_{u} + \w_i + \mubm)^\top \x^n} \right), \\
\frac{\partial J}{\partial \w_i}
&= \frac{\lambda}{N} \w_i + \frac{1}{N} \left( 
   \frac{-1}{M_i^+} \sum_{m: y_i^m = 1} \x^m e^{-(\bv_{u(i)} + \w_i + \mubm)^\top \x^m} 
   + \frac{1}{(M - M_i^+)} \sum_{n: y_i^n = 0} \x^n e^{p (\bv_{u(i)} + \w_i + \mubm)^\top \x^n} \right), \\
\frac{\partial J}{\partial \mubm}
&= \lambda \mubm + \frac{1}{N} \sum_{i=1}^N \left( 
   \frac{-1}{M_i^+} \sum_{m: y_i^m = 1} \x^m e^{-(\bv_{u(i)} + \w_i + \mubm)^\top \x^m} 
   + \frac{1}{(M - M_i^+)} \sum_{n: y_i^n = 0} \x^n e^{p (\bv_{u(i)} + \w_i + \mubm)^\top \x^n} \right).
\end{aligned}
\end{equation*}
