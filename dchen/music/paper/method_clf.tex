\section{Methods}

\subsection{Music recommendation via multitask classification}

We can formulate the music recommendation task as a multi-label classification problem,
where we learn a classifier which hopefully assign positive labels to songs in playlist and negative labels to those not.

To focus on the most plausible songs for playlist $i$ from user $u$,
we use the P-Classification loss, with the exponential surrogate:
\begin{equation*}
\begin{aligned}
\LCal_\textsc{pc}(f, \DCal) 
&= \frac{1}{M_+^i} \sum_{m: y_m^i = 1} e^{-f(u, i, m)} + \frac{1}{M_-^i} \sum_{n: y_n^i = 0} \frac{1}{p} e^{p f(u, i, n)}, \\
\end{aligned}
\end{equation*}
where $M_+^i$ is the number songs in playlist $i$,
$M_-^i = M - M_+^i$,
$p > 0$ is a trade-off parameter,
and $\phibm_{u,m}$ is a feature vector,
which includes audio features, genre, popularity of song $m$,
and the number of listening events from users except $u$.

Another similar loss function is focusing on the song in playlist that has the minimum score,
the unnormalised loss is the number of songs that in playlist while has a higher score, \ie
$$
\LCal_\textsc{pc}'(f, \DCal)
= \frac{1}{p} \sum_{m: y_m^i = 1} e^{-p f(i, m)} + \sum_{n: y_n^i = 0} e^{f(i, n)}.
$$

The empirical risk is
$$
\RCal_\textsc{clf} 
= \frac{1}{N} \sum_{i=1}^N \left( \frac{1}{M_+^i} \sum_{m: y_m^i = 1} e^{-f(u(i),i,m)} 
  + \frac{1}{M_-^i p} \sum_{n: y_n^i = 0} e^{p f(u(i), i,n)} \right),
$$

Let $R(\V, \W, \mubm)$ be the regularisation term:
$$
R(\V, \W, \mubm) 
= \frac{\lambda_1}{2U} \sum_{u=1}^U \bv_u^\top \bv_u + \frac{\lambda_2}{2N} \sum_{i=1}^N \w_i^\top \w_i + \frac{\lambda_3}{2} \mubm^\top \mubm,
$$
where $\lambda_1, \lambda_2, \lambda_3 \in \R_+$ are regularisation constants.

The optimisation problem of this formulation is
\begin{equation*}
\begin{aligned}
\min_{\V, \W, \mubm} \ \RCal_\textsc{clf} + R(\V, \W, \mubm).
\end{aligned}
\end{equation*}
