\subsection{From binary to multi-label}
\label{sec:ml}

Given a multi-label dataset $\SCal = \{\x^n, \y^n\}_{n=1}^N$, where $\x^n \in \R^D$ is a feature vector for the $n$-th example,
and $\y^n \in \{0,1\}^K$ are $K$ labels for the $n$-th example.
One natural approach to extend the loss function in binary setting to the multi-label setting is 
decomposing the empirical loss on $\SCal$ over labels.
In this section, we describe an extension of Theorem~\ref{th:bc=br} in the multi-label setting.

Let function $f$ be
\begin{equation*}
%\resizebox{\linewidth}{!}{$
f_k(\x) := g(\x; \w_k) + b_k, \, k \in \{1,\dots,K\}
%$}
\end{equation*}
where $\w_k$ and $b_k$ is the weight vector and bias parameter for the $k$-th label, respectively,
in other words, we assume the parameters can be decomposed over labels.
Function $g(\x; \w_k)$ is differentiable and bounded.

Suppose $\alpha, \beta \in \R_+$ are \emph{finite} positive numbers, 
and $\C \in \R^K$ is a vector of \emph{finite} (non-zero) real numbers.
We define $\LCal_\textsc{mc}^\text{label}$ be the following empirical loss:
\begin{equation}
\label{eq:mc1}
%\resizebox{.9\linewidth}{!}{$
\displaystyle
\LCal_\textsc{mc}^\text{label}(f; \SCal)
= \sum_{k=1}^K \left(
      \sum_{i: y_k^i = 1} e^{-\alpha f_k(\x^i)} +
  C_k \sum_{j: y_k^j = 0} e^{ \beta  f_k(\x^j)} \right).
%$}
\end{equation}
and let $\LCal_\textsc{mr}^\text{label}$ be a empirical loss defined as
\begin{equation}
\label{eq:mr1}
%\resizebox{.9\linewidth}{!}{$
\begin{aligned}
\displaystyle
\LCal_\textsc{mr}^\text{label}(f; \SCal)
&= \sum_{k=1}^K
   \sum_{y_k^j = 0} \left( \sum_{y_k^i = 1} e^{-\alpha(f_k(\x^i) - f_k(\x^j))} \right)^\frac{\beta}{\alpha} \\
&= \sum_{k=1}^K \left( 
   \sum_{y_k^i = 1} e^{-\alpha f_k(\x^i)} \right)^\frac{\beta}{\alpha} 
   \sum_{y_k^j = 0} e^{ \beta  f_k(\x^j)}.
\end{aligned}
%$}
\end{equation}


Theorem~\ref{th:bc=br} can be extended to the multi-label setting.
\begin{theorem}
\label{theorem:mc1=mr1}
$\LCal_\textsc{mc}^\mathrm{label}$ and $\LCal_\textsc{mr}^\mathrm{label}$ share the same set of minimisers $\WCal_k^*$
(assuming minimisers exist), $k \in \{1,\dots,K\}$, in particular, for $\w_k^* \in \WCal_k^*$,
\begin{equation*}
\begin{aligned}
         \w_k^* & \in \argmin_\W     \, \LCal_\textsc{mr}^\mathrm{label}(f; \SCal), \\
(\w_k^*, b_k^*) & \in \argmin_{\W,\bb} \, \LCal_\textsc{mc}^\mathrm{label}(f; \SCal), \ k \in \{1,\dots,K\}
\end{aligned}
\end{equation*}
where
$$
b_k^*
= \frac{1}{\alpha + \beta} \left(
  \ln \sum_{i: y_k^i = 1} e^{-\alpha g(\x^i; \w_k^*)} - \ln \sum_{j: y_k^j = 0} e^{\beta g(\x^j; \w_k^*)} - \ln (C_k) \right).
$$
\end{theorem}
