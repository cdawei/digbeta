\section{Derivative of multi-label classification objective}

The optimisation objective for playlist augmentation is:
\begin{equation*}
\begin{aligned}
J_\textsc{pla} &= \frac{\lambda}{2} \left( \frac{1}{U} \sum_{u=1}^U \bv_u^\top \bv_u 
     + \frac{1}{N} \sum_{i=1}^N \w_i^\top \w_i + \mubm^\top \mubm \right) \\
& \hspace{3em}
     + \frac{1}{N} \sum_{i=1}^N \left( \frac{1}{M_i^+} \sum_{m: y_m^i = 1} e^{-(\bv_{u(i)} + \w_i + \mubm)^\top \phibm_{u(i),m}} 
     + \frac{1}{(M - M_i^+) p} \sum_{n: y_n^i = 0} e^{p (\bv_{u(i)} + \w_i + \mubm)^\top \phibm_{u(i),n}} \right),
\end{aligned}
\end{equation*}
where $\lambda > 0$ is a regularisation constant.

The gradient w.r.t. $\bv_u, \w_i$ and $\mubm$ are
\begin{equation*}
\begin{aligned}
\frac{\partial J_\textsc{pla}}{\partial \bv_u}
&= \frac{\lambda}{U} \bv_u + \frac{1}{N} \sum_{i \in P_u} \left( 
   \frac{-1}{M_i^+} \sum_{m: y_m^i = 1} \phibm_{u,m} e^{-(\bv_{u} + \w_i + \mubm)^\top \phibm_{u,m}}
   + \frac{1}{(M - M_i^+)} \sum_{n: y_n^i = 0} \phibm_{u,n} e^{p (\bv_{u} + \w_i + \mubm)^\top \phibm_{u,n}} \right), \\
\frac{\partial J_\textsc{pla}}{\partial \w_i}
&= \frac{\lambda}{N} \w_i + \frac{1}{N} \left( 
   \frac{-1}{M_i^+} \sum_{m: y_m^i = 1} \phibm_{u(i),m} e^{-(\bv_{u(i)} + \w_i + \mubm)^\top \phibm_{u(i),m}} \right. \\
& \hspace{7.5em} \left.
   + \frac{1}{(M - M_i^+)} \sum_{n: y_n^i = 0} \phibm_{u(i),n} e^{p (\bv_{u(i)} + \w_i + \mubm)^\top \phibm_{u(i),n}} \right), \\
\frac{\partial J_\textsc{pla}}{\partial \mubm}
&= \lambda \mubm + \frac{1}{N} \sum_{i=1}^N \left( 
   \frac{-1}{M_i^+} \sum_{m: y_m^i = 1} \phibm_{u(i),m} e^{-(\bv_{u(i)} + \w_i + \mubm)^\top \phibm_{u(i),m}} \right. \\
& \hspace{7.5em} \left.
   + \frac{1}{(M - M_i^+)} \sum_{n: y_n^i = 0} \phibm_{u(i),n} e^{p (\bv_{u(i)} + \w_i + \mubm)^\top \phibm_{u(i),n}} \right).
\end{aligned}
\end{equation*}


The optimisation objective for new song recommendation is:
\begin{equation*}
\begin{aligned}
J_\textsc{nsr} &= \frac{\lambda}{2} \left( \frac{1}{U} \sum_{u=1}^U \bv_u^\top \bv_u 
     + \frac{1}{N} \sum_{i=1}^N \w_i^\top \w_i + \mubm^\top \mubm \right) \\
& \hspace{1.5em}
     + \frac{1}{N} \sum_{i=1}^N \left( \frac{1}{M_i^+} \sum_{m: y_m^i = 1} e^{-(\bv_{u(i)} + \w_i + \mubm)^\top \x_m} 
     + \frac{1}{(M - M_i^+) p} \sum_{n: y_n^i = 0} e^{p (\bv_{u(i)} + \w_i + \mubm)^\top \x_n} \right),
\end{aligned}
\end{equation*}
where $\lambda > 0$ is a regularisation constant.


The gradient w.r.t. $\bv_u, \w_i$ and $\mubm$ are
\begin{equation*}
\begin{aligned}
\frac{\partial J_\textsc{nsr}}{\partial \bv_u}
&= \frac{\lambda}{U} \bv_u + \frac{1}{N} \sum_{i \in P_u} \left( 
   \frac{-1}{M_i^+} \sum_{m: y_m^i = 1} \x_m e^{-(\bv_{u} + \w_i + \mubm)^\top \x_m} 
   + \frac{1}{(M - M_i^+)} \sum_{n: y_n^i = 0} \x_n e^{p (\bv_{u} + \w_i + \mubm)^\top \x_n} \right), \\
\frac{\partial J_\textsc{nsr}}{\partial \w_i}
&= \frac{\lambda}{N} \w_i + \frac{1}{N} \left( 
   \frac{-1}{M_i^+} \sum_{m: y_m^i = 1} \x_m e^{-(\bv_{u(i)} + \w_i + \mubm)^\top \x_m} 
   + \frac{1}{(M - M_i^+)} \sum_{n: y_n^i = 0} \x_n e^{p (\bv_{u(i)} + \w_i + \mubm)^\top \x_n} \right), \\
\frac{\partial J_\textsc{nsr}}{\partial \mubm}
&= \lambda \mubm + \frac{1}{N} \sum_{i=1}^N \left( 
   \frac{-1}{M_i^+} \sum_{m: y_m^i = 1} \x_m e^{-(\bv_{u(i)} + \w_i + \mubm)^\top \x_m} 
   + \frac{1}{(M - M_i^+)} \sum_{n: y_n^i = 0} \x_n e^{p (\bv_{u(i)} + \w_i + \mubm)^\top \x_n} \right).
\end{aligned}
\end{equation*}
