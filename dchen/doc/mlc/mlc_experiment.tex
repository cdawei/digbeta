\section{Experiment}
\label{sec:experiment}

We experiment the proposed methods on several multi-label dataset, the statistics are shown in Table~\ref{tab:dataset}.

\begin{table}[!h]
\centering
%\setlength{\tabcolsep}{3pt} % tweak the space between columns
\caption{Statistics of multi-label dataset}
\label{tab:dataset}
\begin{tabular}{l*{7}{r}} \hline \hline
Dataset & \#Examples (train) & \#Examples (test) & \#Features & \#Labels ($K$) & Avg $K_+$ (train) & Avg $K_+$ (test) & $K_+ / K$ \\ \hline
%\texttt{emotions} & 391  & 202  & 6  & 72  \\
\texttt{yeast}     & 1,500  & 917    & 103  & 14  & 4  & 4  & 29\%  \\
\texttt{scene}     & 1,211  & 1,196  & 294  & 6   & 1  & 1  & 17\%  \\ 
\texttt{bibtex}    & 4,880  & 2,515  & 1,836 & 159 & 2  & 2  & 1.3\% \\
\texttt{bookmarks} & 60,000 & 27,856 & 2,150 & 208 & 2  & 2  & 1\%   \\
\texttt{delicious} & 12,910 & 3,181  & 500  & 983 & 19 & 18 & 2\%   \\
\texttt{mediamill} & 29,804 & 12,373 & 120  & 101 & 4  & 4  & 4\%   \\
\hline
\end{tabular}
\end{table}

\noindent
We evaluate the performance of algorithms in terms of four metrics:
\begin{itemize}
\item Precision@3
\item Precision@5
\item Precision@K, where K is the number of positive labels for each example (\ie $K_+^n$)
\item F1 score
\end{itemize}

\noindent
The algorithms in consideration are:
\begin{itemize}
\item LR: Binary relevance (\ie independent logistic regression), regularisation constant $C = 1$.
\item LR-CV: Binary relevance (\ie independent Logistic regression) with \emph{balanced} class weights, $C$ is tuned by cross validation.
\item TP-MLC: Multi-label classification with top-push loss, $C$ is tuned by cross validation.
\end{itemize}

\noindent
The performance of these algorithms are shown in Table~\ref{tab:perf}.

\begin{table}[!h]
\centering
\caption{Performance on test set}
\label{tab:perf}
\begin{tabular}{llllll}
\toprule
       &    & Precision@3 & Precision@5 & Precision@K &                      F1 \\
Dataset & Method &             &             &             &                         \\
\midrule
\multirow{3}{*}{yeast} & LR &      0.7128 &      0.6017 &      0.6348 &                  0.5232 \\
       & LR-CV &      0.5107 &      0.4624 &      0.5042 &                  0.2892 \\
       & TP-MLC &      0.5387 &      0.4534 &      0.5094 &  0.4870, 0.3773, 0.4632 \\
\cline{1-6}
\multirow{3}{*}{scene} & LR &      0.3450 &      0.2166 &      0.7404 &                  0.5141 \\
       & LR-CV &      0.3406 &      0.2167 &      0.7136 &                  0.6548 \\
       & TP-MLC &      0.3456 &      0.2167 &      0.7366 &  0.5056, 0.5480, 0.5462 \\
\cline{1-6}
\multirow{3}{*}{bibtex} & LR &      0.3836 &      0.2815 &      0.4910 &                  0.3250 \\
       & LR-CV &      0.3968 &      0.2923 &      0.5056 &                  0.4415 \\
       & TP-MLC &      0.3931 &      0.2883 &      0.5044 &  0.4042, 0.0675, 0.0675 \\
\cline{1-6}
\multirow{3}{*}{bookmarks} & LR &           - &           - &           - &                       - \\
       & LR-CV &           - &           - &           - &                       - \\
       & TP-MLC &           - &           - &           - &                       - \\
\cline{1-6}
\multirow{3}{*}{delicious} & LR &           - &           - &           - &                       - \\
       & LR-CV &           - &           - &           - &                       - \\
       & TP-MLC &           - &           - &           - &                       - \\
\cline{1-6}
\multirow{3}{*}{mediamill} & LR &           - &           - &           - &                       - \\
       & LR-CV &           - &           - &           - &                       - \\
       & TP-MLC &           - &           - &           - &                       - \\
\bottomrule
\end{tabular}

\end{table}



\begin{table}[!h]
\centering
\caption{Performance on training set}
\begin{tabular}{l|cccc} \hline \hline
 & yeast & scene & bibtex & bookmarks \\ \hline
 & \multicolumn{4}{c}{Average Precision@3} \\ \hline
TP-MLC & $0.6022 \pm  0.008$ & $0.3496 \pm  0.002$ & $0.6430 \pm  0.004$ & $0.3576 \pm  0.001$ \\
LR-CV & $0.6051 \pm  0.008$ & $0.3287 \pm  0.003$ & $0.6139 \pm  0.004$ & - \\
DVN & - & - & 0.636 $\pm$ 0.004 & 0.365 $\pm$ 0.001 \\ \hline
 & \multicolumn{4}{c}{Average Precision@5} \\ \hline
TP-MLC & $0.5060 \pm  0.007$ & $0.2122 \pm  0.001$ & $0.4420 \pm  0.004$ & $0.2496 \pm  0.001$ \\
LR-CV & $0.5249 \pm  0.007$ & $0.2122 \pm  0.001$ & $0.4277 \pm  0.003$ & - \\
DVN & - & - & 0.439 $\pm$ 0.004 & 0.249 $\pm$ 0.001 \\ \hline
 & \multicolumn{4}{c}{Average Precision@K} \\ \hline
TP-MLC & $0.5690 \pm  0.008$ & $0.8852 \pm  0.009$ & $0.9647 \pm  0.002$ & $0.6016 \pm  0.002$ \\
LR-CV & $0.5719 \pm  0.008$ & $0.6647 \pm  0.013$ & $0.8774 \pm  0.003$ & - \\
DVN & - & - & 0.945 $\pm$ 0.003 & 0.597 $\pm$ 0.002 \\ \hline
 & \multicolumn{4}{c}{Average F1} \\ \hline
TP-MLC & $0.5275 \pm  0.006$ & $0.5478 \pm  0.004$ & $0.0680 \pm  0.001$ & $0.0426 \pm  0.000$ \\
LR-CV & $0.4781 \pm  0.008$ & $0.5244 \pm  0.014$ & $0.7795 \pm  0.003$ & - \\
DVN & - & - & 0.905 $\pm$ 0.003 & - \\ \hline
\end{tabular}
\end{table}


\begin{table}[!h]
\centering
\caption{Performance on test set}
\begin{tabular}{l|cccc} \hline \hline
 & yeast & scene & bibtex & bookmarks \\ \hline
 & \multicolumn{4}{c}{Average Precision@3} \\ \hline
TP-MLC & $0.5387 \pm  0.011$ & $0.3459 \pm  0.003$ & $0.3931 \pm  0.006$ & $0.2691 \pm  0.001$ \\
LR-CV & $0.5198 \pm  0.011$ & $0.3244 \pm  0.004$ & $0.3474 \pm  0.006$ & - \\
DVN & - & - & 0.364 $\pm$ 0.005 & - \\ \hline
 & \multicolumn{4}{c}{Average Precision@5} \\ \hline
TP-MLC & $0.4534 \pm  0.008$ & $0.2167 \pm  0.002$ & $0.2883 \pm  0.004$ & $0.1943 \pm  0.001$ \\
LR-CV & $0.4654 \pm  0.009$ & $0.2167 \pm  0.002$ & $0.2564 \pm  0.004$ & - \\
DVN & - & - & 0.263 $\pm$ 0.004 & - \\ \hline
 & \multicolumn{4}{c}{Average Precision@K} \\ \hline
TP-MLC & $0.5094 \pm  0.010$ & $0.7358 \pm  0.012$ & $0.5044 \pm  0.008$ & $0.4306 \pm  0.003$ \\
LR-CV & $0.5031 \pm  0.010$ & $0.6564 \pm  0.013$ & $0.4552 \pm  0.008$ & - \\
DVN & - & - & 0.474 $\pm$ 0.008 & - \\ \hline
 & \multicolumn{4}{c}{Average F1} \\ \hline
TP-MLC & $0.4811 \pm  0.008$ & $0.5295 \pm  0.005$ & $0.0669 \pm  0.001$ & $0.0416 \pm  0.000$ \\
LR-CV & $0.4171 \pm  0.010$ & $0.4971 \pm  0.014$ & $0.4282 \pm  0.007$ & - \\
DVN & - & - & 0.447 $\pm$ 0.007 & - \\ \hline
\end{tabular}
\end{table}
